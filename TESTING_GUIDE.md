# 用户账户系统测试指南

## 测试准备

### 1. 启动服务器

**后端服务器：**
```bash
node server/index.js
```
应该看到：`Server running on http://localhost:5002`

**前端服务器：**
```bash
cd client
npm start
```
应该自动打开浏览器到 http://localhost:3001

### 2. 检查服务器状态

```bash
node check-servers.js
```

如果两个服务器都运行正常，可以开始测试。

## 快速测试流程

### 方式1：自动化测试（推荐）

```bash
node test-account-system.js
```

这个脚本会自动测试：
- ✅ 用户注册
- ✅ 添加/编辑/删除地址
- ✅ 添加/删除支付方式
- ✅ 创建订单
- ✅ 查看订单历史

预期结果：16个测试全部通过

### 方式2：手动测试

详细步骤请参考：`test-account-manual.md`

## 核心功能测试清单

### ✅ 地址管理
1. 打开 http://localhost:3001/login
2. 注册/登录账户
3. 进入"我的账户" → "收货地址"
4. 点击"+ 添加新地址"
5. 填写表单并保存
6. 验证地址显示在列表中
7. 点击"编辑"修改地址
8. 点击"删除"删除地址

### ✅ 支付方式管理
1. 进入"支付方式"标签
2. 点击"+ 添加支付方式"
3. 填写卡信息：
   - 卡号：4242 4242 4242 4242
   - 持卡人：测试用户
   - 有效期：12/2028
   - CVV：123
4. 保存并验证显示
5. 验证只显示后4位：****4242

### ✅ 结账自动填充
1. 添加商品到购物车
2. 进入结账页面
3. 验证自动填充：
   - ✅ 邮箱已填充
   - ✅ 显示"已登录"提示
4. 进入第二步：
   - ✅ 地址已填充
   - ✅ 显示"使用默认地址"提示
5. 进入第三步：
   - ✅ 支付方式已填充

### ✅ 订单历史
1. 完成一个订单
2. 进入"订单历史"标签
3. 验证订单显示：
   - ✅ 订单号
   - ✅ 订单状态（带颜色）
   - ✅ 订单金额
   - ✅ 商品数量

## 测试数据示例

### 测试地址
```
地址标签: 家
名: 测试
姓: 用户
电话: +886912345678
国家: Taiwan
城市: Taipei
地址: 信义路五段7号
地址2: 101大楼
邮编: 110
```

### 测试支付方式
```
卡类型: Visa
卡号: 4242 4242 4242 4242
持卡人: 测试用户
有效期: 12/2028
CVV: 123
```

## 预期行为

### 地址管理
- ✅ 可以添加多个地址
- ✅ 可以设置一个为默认
- ✅ 默认地址显示"默认"标签
- ✅ 可以编辑任何地址
- ✅ 可以删除任何地址

### 支付方式管理
- ✅ 可以添加多个支付方式
- ✅ 可以设置一个为默认
- ✅ 默认支付方式显示"默认"标签
- ✅ 只显示卡号后4位
- ✅ 不显示完整卡号和CVV
- ✅ 可以删除任何支付方式

### 结账自动填充
- ✅ 登录用户自动填充邮箱
- ✅ 自动填充默认地址
- ✅ 自动填充默认支付方式
- ✅ 显示绿色提示框
- ✅ 可以手动修改自动填充的信息
- ✅ 游客用户正常手动填写

### 订单历史
- ✅ 显示所有订单
- ✅ 订单按时间倒序排列
- ✅ 显示订单状态（不同颜色）
- ✅ 显示订单金额
- ✅ 空状态显示提示信息

## 常见问题

### Q: 服务器未运行
A: 运行 `node check-servers.js` 检查状态，然后启动相应服务器

### Q: 自动化测试失败
A: 确保服务器正在运行，然后重新运行测试

### Q: 无法添加地址
A: 确保已登录，检查浏览器控制台是否有错误

### Q: 结账时没有自动填充
A: 确保已添加默认地址和支付方式

### Q: 看不到订单历史
A: 确保已完成至少一个订单

## 测试报告

测试完成后，请记录：

### 通过的功能
- [ ] 用户注册/登录
- [ ] 添加地址
- [ ] 编辑地址
- [ ] 删除地址
- [ ] 设置默认地址
- [ ] 添加支付方式
- [ ] 删除支付方式
- [ ] 设置默认支付方式
- [ ] 结账自动填充邮箱
- [ ] 结账自动填充地址
- [ ] 结账自动填充支付方式
- [ ] 创建订单
- [ ] 查看订单历史
- [ ] 响应式设计
- [ ] 表单验证

### 发现的问题
如果发现问题，请记录：
1. 问题描述
2. 重现步骤
3. 预期行为
4. 实际行为
5. 浏览器和版本
6. 截图（如果适用）

## 性能测试

### 加载速度
- [ ] 账户页面加载 < 1秒
- [ ] 地址列表加载 < 500ms
- [ ] 支付方式列表加载 < 500ms
- [ ] 订单历史加载 < 1秒

### 响应速度
- [ ] 添加地址 < 500ms
- [ ] 编辑地址 < 500ms
- [ ] 删除地址 < 300ms
- [ ] 添加支付方式 < 500ms
- [ ] 删除支付方式 < 300ms

## 安全测试

### 认证测试
- [ ] 未登录无法访问 /account
- [ ] 未登录无法访问用户API
- [ ] 登出后无法访问账户数据

### 数据安全
- [ ] 不存储完整卡号
- [ ] 不存储CVV
- [ ] 只显示卡号后4位
- [ ] 用户只能访问自己的数据

## 浏览器兼容性

测试以下浏览器：
- [ ] Chrome (最新版)
- [ ] Firefox (最新版)
- [ ] Safari (最新版)
- [ ] Edge (最新版)

## 移动端测试

测试以下设备：
- [ ] iPhone (Safari)
- [ ] Android (Chrome)
- [ ] iPad (Safari)

## 总结

完成所有测试后：
1. 统计通过/失败的测试数量
2. 记录发现的问题
3. 评估系统稳定性
4. 提出改进建议

---

**测试日期：** _____________

**测试人员：** _____________

**测试结果：** ⭕ 通过 / ❌ 失败

**备注：** _____________
